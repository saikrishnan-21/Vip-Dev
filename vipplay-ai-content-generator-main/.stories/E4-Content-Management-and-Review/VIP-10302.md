# VIP-10302: View Content Details & Preview

**Story ID**: VIP-10302
**Story Type**: Story
**Epic**: E4-Content-Management-and-Review
**Priority**: High
**Story Points**: 3
**Status**: In Progress

## User Story

As a user, I want to view detailed information and preview generated content so that I can thoroughly review it before approval or publishing

## Acceptance Criteria

- [ ] **AC1**: User can click on a content item from the list to open a detailed view modal/page
- [ ] **AC2**: Content details should display: title, full content, generation time, word count, SEO score, readability score
- [ ] **AC3**: User can see metadata: generation mode (topic/keywords/trends/spin), keywords used, model used
- [ ] **AC4**: User can see "Nerd Stats" section showing: estimated reading time, keyword density, sentence metrics, Flesch reading ease
- [ ] **AC5**: User can see SEO Analysis checklist with individual item scores
- [ ] **AC6**: Content preview should be rich-text with proper formatting, images, and links displayed
- [ ] **AC7**: User can perform actions from detail view: Approve, Reject, Edit, Delete, Re-review, Export
- [ ] **AC8**: Detail view properly handles different content statuses (pending, approved, rejected, published)
- [ ] **AC9**: Closing the detail view returns to the content list without losing filter state
- [ ] **AC10**: User isolation is enforced - users cannot view other users' content details

## Technical Details

### Backend (Already Implemented)
- **Endpoint**: `GET /api/content/[contentId]` (protected via `withAuth` HOF)
- **Response Format**:
  ```json
  {
    "_id": "string",
    "title": "string",
    "content": "string (full content body)",
    "status": "string",
    "generatedAt": "ISO date",
    "keywords": ["string"],
    "metadata": {
      "wordCount": "number",
      "sourceType": "topic|keywords|trends|spin",
      "model": "string",
      "temperature": "number"
    },
    "seoAnalysis": {
      "score": "number (0-100)",
      "items": [
        {
          "name": "string",
          "score": "number",
          "status": "pass|fail"
        }
      ]
    },
    "readabilityAnalysis": {
      "flesch_ease": "number",
      "grade_level": "number",
      "avg_words_per_sentence": "number",
      "reading_time_minutes": "number"
    },
    "createdAt": "ISO date",
    "updatedAt": "ISO date"
  }
  ```
- **User Isolation**: Endpoint checks `content.userId === user.userId` and returns 404 if no match
- **Authorization**: Any authenticated user can view their own content

### Frontend (To Be Implemented)
- **Component**: Modal or sidebar panel in `/app/dashboard/content/page.tsx`
- **Requirements**:
  - Open detail view when user clicks on content item
  - Display full content with rich formatting
  - Show all metadata and analysis scores
  - Include action buttons: Approve, Reject, Edit, Delete, Export
  - Add close button (X) to dismiss modal
  - Maintain filter/search state when closing
  - Handle loading state while fetching content
  - Handle error state gracefully

### Display Sections
1. **Header**: Title, Status badge, Generation time
2. **Content Preview**: Full content body with formatting
3. **Metadata Panel**: Word count, reading time, generation mode, model
4. **Keywords Section**: Comma-separated or badge display
5. **Nerd Stats**: Flesch score, reading time, keyword density, sentence metrics
6. **SEO Analysis**: Checklist with individual scores
7. **Action Buttons**: Approve, Reject, Edit, Delete, Export, Re-review

### Database
- **Collection**: `generated_content`
- **Fields Used**: All fields (full content retrieval)
- **Index**: Already created `{userId: 1}`

## Definition of Done

- [x] Story details defined
- [ ] API endpoint verified and working
- [ ] Frontend modal/page component created
- [ ] All metadata sections implemented
- [ ] Nerd stats properly calculated and displayed
- [ ] SEO analysis section implemented
- [ ] Action buttons wired to appropriate endpoints
- [ ] User isolation verified
- [ ] Loading and error states implemented
- [ ] All acceptance criteria met
- [ ] Unit tests written
- [ ] E2E tests passing
- [ ] Code reviewed and approved
- [ ] Merged to main branch

## Implementation Notes

### Key Components to Use
- Modal/Sheet component from shadcn/ui (Dialog or Drawer)
- Rich text display (handle markdown or HTML rendering safely)
- Badge component for status and keywords
- Progress bars for scores (SEO, readability)
- Button group for actions

### Performance Considerations
- Lazy load detail content only when modal opens
- Cache recently viewed content details
- Virtualize long content if needed

### Accessibility
- Modal should trap focus
- All interactive elements keyboard accessible
- ARIA labels for all sections
- Proper heading hierarchy

### Related Stories
- VIP-10304: Approve Content Workflow (uses action buttons from this story)
- VIP-10305: Reject Content with Notes (uses action buttons)
- VIP-10303: Inline Content Editor (Edit action from this story)
- VIP-10307: Display Nerd Stats (detailed metrics display)

## Notes

- Backend API endpoint already fully implemented
- Frontend currently shows content preview in sidebar (works with hardcoded data)
- Main work is converting to real API integration
- Consider showing content in read-only mode initially
- Actions (Approve, Reject, Edit) depend on other stories in this epic
